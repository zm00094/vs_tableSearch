<!DOCTYPE html>
<meta charset="utf-8">
<script src="https://d3js.org/d3.v3.js"></script>
<script src="localTools.js"></script>
<script src='data/drg.js'></script>
<script src='data/hcpcs.js'></script>
<link rel="stylesheet" href="styles.css">
<body>
  <div id="framework" style="display:table">
    <div style="display:table-row;">
      <div style="width:70%; display:table-cell;" class="leftHalf">
        <div ><h1 id="searchTableTitle"></h1></div>
        <div class="tab">
          <button class="tablink" onclick="j_lt.selectTab('hcpcs')" id="defaultPage">HCPCS Procedures</button>
          <button class="tablink" onclick="j_lt.selectTab('drg')">Hospitalizations</button>
        </div>
        <div id="searchForm"></div>
      </div>
      <div style="width:30%; display:table-cell;padding-left:40px;" class="rightHalf">
        <div ><h1 id="patientID">Patient ID: XXX</h1></div>
        <div id="sexForm"></div>
        <div id="ageForm"></div>
      </div>
    </div>
    <div style="display:table-row">
      <div style="display:table-cell" class="leftHalf">
        <div id="searchTable"></div>
      </div>
      <div style="display:table-cell;vertical-align:top;padding-left:40px;" class="rightHalf">
        <div id="patientTable"></div>
      </div>
    </div>
  </div>
</body>
<script>

d3.select("#searchForm").append("div")
  .attr("class", "SearchBar")
  .append("p")
    .attr("class", "SearchBar")
    .text("Search:");

d3.select(".SearchBar")
  .append("input")
    .attr("class", "SearchBar")
    .attr("id", "search")
    .attr("type", "text")
    .attr("placeholder", "Search...");
  
dl={'hcpcs':{'header':'HCPCS Codes','data':hcpcs.data,'searchColumn':'SHORT DESCRIPTION'}
  ,'drg':{'header':'Hospitalizations','data':drg.data,'searchColumn':'Description'}}
var currentTable='drg'
var currentPatient='XXXX'

var table = d3.select("#searchTable").append("table");
table.append("thead").append('tr').append('th')
table.append('tbody').append('tr').append('td')

j_lt.selectTab(currentTable)

var ptab = d3.select("#patientTable").append("table");
var ptArray=[]
ptab.append('thead').append('tr').selectAll('th').data(['Path','Type','Code'])
        .enter().append("th").text(function(d){return d})
ptab.append('tbody')
// ptab.append('tbody').selectAll("tr")
//         .data(emptyPt).enter().append('tr').append('tr').append('td')

// search
d3.select("#search")
  .on("keyup", function() { // filter according to key pressed 
    table.select('tbody').selectAll("tr").remove()
    j_lt.popRows(dl[currentTable].data.filter(d=>RegExp(this.value.trim(),'i').test(d[dl[currentTable].searchColumn])))
  })

d3.select(self.frameElement).style("height", "780px").style("width", "1150px");	
</script>
